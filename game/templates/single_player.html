{% load static %}
<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Lobster+Two:ital,wght@0,700;1,700&family=Nunito:wght@700;800;900&family=Pushster&display=swap"
        rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <link rel="stylesheet" href="{% static 'singleplayer_style.css' %}">
    <!-- <script src="{% static 'js/single_player.js' %}"></script> -->

    <title>Stone Paper Scissor - SinglePlayer</title>
</head>

<body>

    <div class="heading">
        <div class="tag">
            <h1>Let's Play !! <span><i class="far fa-laugh-beam fas-3x"></i></span></h1>
        </div>
    </div>

    <div class="row cams">

        <div class="col-lg-5 player-1-div">
            <div class="player-1-cam">
                <button onclick="switchOnCamera()" id="on-cam-btn">Open Camera</button>
                <img src="" id="cam-on" alt="player-1-cam" class="cam-design" width="100%" height="100%"
                    style="display: none; position: relative">
                <button onclick="closeCamera()" id="close-cam-btn" class="close-cam-icon"><i class="fa-solid fa-xmark" style="color: red;"></i></button>
            </div>
        </div>
        <div class="col-lg-2 v-s">
            <!-- HTML !-->
            <button class="sps-btn" onclick="startGame()" role="button" style="font-size: 0.9rem;">S-P-S</button>
            <h1 id="timer" class="design-timer"></h1>
        </div>
        <div class="col-lg-5 player-2-div">
            <div class="player-2-cam">
                <img src="../static/images/basic_game_img.png" id="change-img" alt="sps-image"
                    class="player-2-img-design">
            </div>
        </div>

    </div>

    <div class="row result">
        <h1 id="write-abt-result">You Have Won <i class="fa-solid fa-face-grin"></i></h1>
        <!-- <h1>Computer Have Won <i class="fa-solid fa-face-sad-tear"></i></h1> -->
    </div>

    <div class="row score">

        <div class="col-lg-5 player-1-div">
            <div class="player-1-score">
                <h1 id="display-player-1-score">0</h1>
            </div>
        </div>
        <div class="col-lg-2 v-s"></div>
        <div class="col-lg-5 player-2-div">
            <div class="player-2-score">
                <h1 id="display-player-2-score">0</h1>
                <!-- <h1>{{js_data}}</h1> -->
            </div>
        </div>

    </div>


    <!-- Optional JavaScript; choose one of the two! -->

    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
        crossorigin="anonymous"></script>

    <!-- Option 2: Separate Popper and Bootstrap JS -->
    <!--
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
    -->

    <script type="text/javascript">



        //    let user_input = JSON.parse("{{ js_data }}");
        //    console.log(user_input);

        const img_set_arr = ['../static/images/stone_game_img.png', '../static/images/paper_game_img.png', '../static/images/scissor_game_img.png'];
        let i = 0;
        const img = document.getElementById('change-img');
        const camera = document.getElementById('cam-on');
        const camera_btn = document.getElementById('on-cam-btn');
        const close_cam_btn = document.getElementById('close-cam-btn');
        const disp_p_1_score = document.getElementById('display-player-1-score');
        const disp_p_2_score = document.getElementById('display-player-2-score');
        let x, ans, count, t, p_1_score, p_2_score;
        p_1_score = 0;
        p_2_score = 0;

        function switchOnCamera() {
            camera.style.display = 'block';
            camera.src = "{% url 'video_feed' %}";
            camera_btn.style.display = 'none';
            close_cam_btn.style.display = 'block';
        }

        function closeCamera()
        {
            camera.style.display = 'none';
            camera.src = "";
            camera_btn.style.display = 'block';
            close_cam_btn.style.display = 'none';
        }

        function startGame() {
            if (camera.src === '' || camera.style.display === 'none') {
                alert('Please Switch on the Camera by Clicking on "Open Camera" button');
                return;
            }
            else {
                count = 3;
                document.getElementById('timer').innerHTML = count;
                img.src = '../static/images/stone_game_img.png';
                x = setInterval(changeImage, 100);
                ans = Math.floor(Math.random() * 3);
                setTimeout(gameResult, 3000);
                t = setInterval(reduceTime, 1000);
            }
        }

        function reduceTime() {
            count = count - 1;
            document.getElementById('timer').innerHTML = count;
        }

        function changeImage() {
            img.src = img_set_arr[(i + 1) % 3];
            i = i + 1;
        }

        function gameResult() {
            console.warn(img.src);
            img.src = img_set_arr[ans];
            clearInterval(x);
            clearInterval(t);
            document.getElementById('timer').innerHTML = "";
            disp_p_1_score.innerHTML = p_1_score;
            disp_p_2_score.innerHTML = p_2_score;
        }
    </script>
</body>

</html>